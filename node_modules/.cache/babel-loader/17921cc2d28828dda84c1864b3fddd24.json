{"ast":null,"code":"import _objectSpread from\"C:/Users/lepau/src/ZOE Inc/zoe-inc-and-associates-project/zoe-inc-and-associates/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/lepau/src/ZOE Inc/zoe-inc-and-associates-project/zoe-inc-and-associates/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/lepau/src/ZOE Inc/zoe-inc-and-associates-project/zoe-inc-and-associates/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{firebaseConfig}from\"./config\";import firebase from'firebase/compat/app';import'firebase/compat/auth';import'firebase/compat/firestore';var app=firebase.initializeApp(firebaseConfig);export var auth=firebase.auth();export var firestore=firebase.firestore();export var handleSignUp=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(displayName,email,password,confirmPassword){var user;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:user=null;_context.prev=1;if(!(password===confirmPassword)){_context.next=10;break;}_context.next=5;return auth.createUserWithEmailAndPassword(email,password);case 5:user=_context.sent;// .then(userCredentials => {\n// user = userCredentials\nhandleUserProfile(user.user,{displayName:displayName});return _context.abrupt(\"return\",user);case 10:throw'Passwords Do Not Match.';case 11:_context.next=17;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);console.log(_context.t0);throw _context.t0;case 17:case\"end\":return _context.stop();}}},_callee,null,[[1,13]]);}));return function handleSignUp(_x,_x2,_x3,_x4){return _ref.apply(this,arguments);};}();export var handleUserProfile=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(userAuth,additionalData){var uid,userRef,snapshot,displayName,email,timeStamp,userRoles;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(userAuth){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:uid=userAuth.uid;// console.log(`${uid} Storing in firestore database...`)\nuserRef=firestore.doc(\"users/\".concat(uid));_context2.next=6;return userRef.get();case 6:snapshot=_context2.sent;if(snapshot.exists){_context2.next=19;break;}displayName=userAuth.displayName,email=userAuth.email;timeStamp=new Date();userRoles=['user'];_context2.prev=11;_context2.next=14;return userRef.set(_objectSpread({displayName:displayName,email:email,createdDate:timeStamp,userRoles:userRoles},additionalData));case 14:_context2.next=19;break;case 16:_context2.prev=16;_context2.t0=_context2[\"catch\"](11);console.log(_context2.t0);case 19:return _context2.abrupt(\"return\",userRef);case 20:case\"end\":return _context2.stop();}}},_callee2,null,[[11,16]]);}));return function handleUserProfile(_x5,_x6){return _ref2.apply(this,arguments);};}();export var getSnapshotFromUserAuth=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(user){var snapshot;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return handleUserProfile(user);case 2:_context3.next=4;return _context3.sent.get();case 4:snapshot=_context3.sent;return _context3.abrupt(\"return\",snapshot);case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function getSnapshotFromUserAuth(_x7){return _ref3.apply(this,arguments);};}();export var getCurrentUser=function getCurrentUser(){return new Promise(function(resolve,reject){var unsubscribe=auth.onAuthStateChanged(function(userAuth){unsubscribe();resolve(userAuth);},reject);});};export var handleResetPasswordAPI=function handleResetPasswordAPI(email){var config={url:'http://localhost:3000/login'};return new Promise(function(resolve,reject){auth.sendPasswordResetEmail(email,config).then(function(){resolve();}).catch(function(){var err=['Email not found. Please try again.'];reject(err);});});};","map":{"version":3,"names":["firebaseConfig","firebase","app","initializeApp","auth","firestore","handleSignUp","displayName","email","password","confirmPassword","user","createUserWithEmailAndPassword","handleUserProfile","console","log","userAuth","additionalData","uid","userRef","doc","get","snapshot","exists","timeStamp","Date","userRoles","set","createdDate","getSnapshotFromUserAuth","getCurrentUser","Promise","resolve","reject","unsubscribe","onAuthStateChanged","handleResetPasswordAPI","config","url","sendPasswordResetEmail","then","catch","err"],"sources":["C:/Users/lepau/src/ZOE Inc/zoe-inc-and-associates-project/zoe-inc-and-associates/src/Firebase/utils.js"],"sourcesContent":["import { firebaseConfig } from \"./config\";\r\nimport firebase from 'firebase/compat/app';\r\nimport 'firebase/compat/auth';\r\nimport 'firebase/compat/firestore';\r\n\r\nconst app = firebase.initializeApp(firebaseConfig)\r\n\r\nexport const auth = firebase.auth()\r\nexport const firestore = firebase.firestore()\r\n\r\n\r\nexport const handleSignUp = async (displayName, email, password, confirmPassword) => {\r\n\r\n    let user = null\r\n\r\n    try{\r\n      if(password === confirmPassword){\r\n        user = await auth.createUserWithEmailAndPassword(email, password)\r\n        // .then(userCredentials => {\r\n            // user = userCredentials\r\n            handleUserProfile( user.user, { displayName })\r\n            return user\r\n        // }).catch(error => {console.log(error)})\r\n      }else{\r\n          throw 'Passwords Do Not Match.'\r\n      }\r\n    }catch(err){\r\n      console.log(err)\r\n      throw err\r\n    }  \r\n}\r\n\r\n\r\nexport const handleUserProfile = async(userAuth, additionalData) => {\r\n\r\n    // console.log(userAuth)\r\n\r\n    if(!userAuth) return\r\n\r\n    const { uid } = userAuth\r\n\r\n    // console.log(`${uid} Storing in firestore database...`)\r\n\r\n    const userRef = firestore.doc(`users/${uid}`)\r\n\r\n    const snapshot = await userRef.get()\r\n    \r\n\r\n    if(!snapshot.exists){\r\n        const { displayName, email} = userAuth\r\n        const timeStamp = new Date()\r\n        const userRoles = ['user']\r\n        try{\r\n            await userRef.set({\r\n                displayName,\r\n                email,\r\n                createdDate: timeStamp,\r\n                userRoles,\r\n                ...additionalData\r\n            })\r\n        }catch(err){\r\n            console.log(err)\r\n        }\r\n    }\r\n    // console.log(userRef)\r\n    \r\n    return userRef\r\n}\r\n\r\nexport const getSnapshotFromUserAuth = async (user) => {\r\n    // console.log(user)\r\n    const snapshot = await (await handleUserProfile(user)).get()\r\n    // console.log(snapshot)\r\n    return snapshot\r\n}\r\n\r\nexport const getCurrentUser = () => {\r\n    return new Promise((resolve, reject) => {\r\n      const unsubscribe = auth.onAuthStateChanged(userAuth => {\r\n        unsubscribe();\r\n        resolve(userAuth);\r\n      }, reject);\r\n    })\r\n}\r\n\r\nexport const handleResetPasswordAPI = (email) => {\r\n    const config = {\r\n      url: 'http://localhost:3000/login'\r\n    };\r\n  \r\n    return new Promise((resolve, reject) => {\r\n      auth.sendPasswordResetEmail(email, config)\r\n        .then(() => {\r\n          resolve();\r\n        })\r\n        .catch(() => {\r\n          const err = ['Email not found. Please try again.'];\r\n          reject(err);\r\n        });\r\n    });\r\n  };"],"mappings":"igBAAA,OAASA,cAAT,KAA+B,UAA/B,CACA,MAAOC,SAAP,KAAqB,qBAArB,CACA,MAAO,sBAAP,CACA,MAAO,2BAAP,CAEA,GAAMC,IAAG,CAAGD,QAAQ,CAACE,aAAT,CAAuBH,cAAvB,CAAZ,CAEA,MAAO,IAAMI,KAAI,CAAGH,QAAQ,CAACG,IAAT,EAAb,CACP,MAAO,IAAMC,UAAS,CAAGJ,QAAQ,CAACI,SAAT,EAAlB,CAGP,MAAO,IAAMC,aAAY,4FAAG,iBAAOC,WAAP,CAAoBC,KAApB,CAA2BC,QAA3B,CAAqCC,eAArC,6HAEpBC,IAFoB,CAEb,IAFa,sBAKnBF,QAAQ,GAAKC,eALM,iDAMPN,KAAI,CAACQ,8BAAL,CAAoCJ,KAApC,CAA2CC,QAA3C,CANO,QAMpBE,IANoB,eAOpB;AACI;AACAE,iBAAiB,CAAEF,IAAI,CAACA,IAAP,CAAa,CAAEJ,WAAW,CAAXA,WAAF,CAAb,CAAjB,CATgB,gCAUTI,IAVS,eAaZ,yBAbY,0FAgBtBG,OAAO,CAACC,GAAR,cAhBsB,uFAAH,kBAAZT,aAAY,wDAAlB,CAsBP,MAAO,IAAMO,kBAAiB,6FAAG,kBAAMG,QAAN,CAAgBC,cAAhB,0LAIzBD,QAJyB,mEAMrBE,GANqB,CAMbF,QANa,CAMrBE,GANqB,CAQ7B;AAEMC,OAVuB,CAUbd,SAAS,CAACe,GAAV,iBAAuBF,GAAvB,EAVa,wBAYNC,QAAO,CAACE,GAAR,EAZM,QAYvBC,QAZuB,mBAezBA,QAAQ,CAACC,MAfgB,2BAgBjBhB,WAhBiB,CAgBKS,QAhBL,CAgBjBT,WAhBiB,CAgBJC,KAhBI,CAgBKQ,QAhBL,CAgBJR,KAhBI,CAiBnBgB,SAjBmB,CAiBP,GAAIC,KAAJ,EAjBO,CAkBnBC,SAlBmB,CAkBP,CAAC,MAAD,CAlBO,2CAoBfP,QAAO,CAACQ,GAAR,gBACFpB,WAAW,CAAXA,WADE,CAEFC,KAAK,CAALA,KAFE,CAGFoB,WAAW,CAAEJ,SAHX,CAIFE,SAAS,CAATA,SAJE,EAKCT,cALD,EApBe,+FA4BrBH,OAAO,CAACC,GAAR,eA5BqB,yCAiCtBI,OAjCsB,0EAAH,kBAAjBN,kBAAiB,kDAAvB,CAoCP,MAAO,IAAMgB,wBAAuB,6FAAG,kBAAOlB,IAAP,4JAELE,kBAAiB,CAACF,IAAD,CAFZ,+CAEoBU,GAFpB,UAE7BC,QAF6B,iDAI5BA,QAJ4B,0DAAH,kBAAvBO,wBAAuB,8CAA7B,CAOP,MAAO,IAAMC,eAAc,CAAG,QAAjBA,eAAiB,EAAM,CAChC,MAAO,IAAIC,QAAJ,CAAY,SAACC,OAAD,CAAUC,MAAV,CAAqB,CACtC,GAAMC,YAAW,CAAG9B,IAAI,CAAC+B,kBAAL,CAAwB,SAAAnB,QAAQ,CAAI,CACtDkB,WAAW,GACXF,OAAO,CAAChB,QAAD,CAAP,CACD,CAHmB,CAGjBiB,MAHiB,CAApB,CAID,CALM,CAAP,CAMH,CAPM,CASP,MAAO,IAAMG,uBAAsB,CAAG,QAAzBA,uBAAyB,CAAC5B,KAAD,CAAW,CAC7C,GAAM6B,OAAM,CAAG,CACbC,GAAG,CAAE,6BADQ,CAAf,CAIA,MAAO,IAAIP,QAAJ,CAAY,SAACC,OAAD,CAAUC,MAAV,CAAqB,CACtC7B,IAAI,CAACmC,sBAAL,CAA4B/B,KAA5B,CAAmC6B,MAAnC,EACGG,IADH,CACQ,UAAM,CACVR,OAAO,GACR,CAHH,EAIGS,KAJH,CAIS,UAAM,CACX,GAAMC,IAAG,CAAG,CAAC,oCAAD,CAAZ,CACAT,MAAM,CAACS,GAAD,CAAN,CACD,CAPH,EAQD,CATM,CAAP,CAUD,CAfI"},"metadata":{},"sourceType":"module"}